"use strict";(self.webpackChunkreact_vadim=self.webpackChunkreact_vadim||[]).push([[742],{4742:function(e,s,a){a.r(s),a.d(s,{default:function(){return p}});var n=a(443),o=a(885),i=a(2791),t={dialogs:"Dialogs_dialogs__GBcEp",dialogsUsers:"Dialogs_dialogsUsers__LBmt6",dialogDiv:"Dialogs_dialogDiv__uycfj",dialogItem:"Dialogs_dialogItem__k9CuM",active:"Dialogs_active__zK1A-",titleMessages:"Dialogs_titleMessages__2oe-t",messages:"Dialogs_messages__Ly6dr",addMessage:"Dialogs_addMessage__+SI4K",inputAddMessage:"Dialogs_inputAddMessage__KTTQa",buttonAddMessage:"Dialogs_buttonAddMessage__gnvoU",divAddMessage:"Dialogs_divAddMessage__EcDqL",iconMessage:"Dialogs_iconMessage__L+5-e",message:"Dialogs_message__pyaWz",divMessage:"Dialogs_divMessage__lpG8t",messageForm:"Dialogs_messageForm__5uYWH",divOwnerMessage:"Dialogs_divOwnerMessage__vv-7J",ownerMessageForm:"Dialogs_ownerMessageForm__zHNC0",textMessage:"Dialogs_textMessage__rleMB",ownerTextMessage:"Dialogs_ownerTextMessage__Sdmym",h3text:"Dialogs_h3text__5icbU",ownerMessageViewed:"Dialogs_ownerMessageViewed__boBPG",textMessageViewed:"Dialogs_textMessageViewed__i1cxU",deleteMessageOn:"Dialogs_deleteMessageOn__Uwr8k",deleteMessageOff:"Dialogs_deleteMessageOff__FcrKb",deleteMessageIcon:"Dialogs_deleteMessageIcon__unqLp",activeMessage:"Dialogs_activeMessage__ie+E3",warningDeleteMessage:"Dialogs_warningDeleteMessage__6S48Q"},d=a(3504),g=a(184),r=function(e){return(0,g.jsx)(d.OL,{to:"/dialogs/"+e.id,onClick:function(){e.onGetMessagesUser(e.id)},className:function(e){return e.isActive?t.active:t.dialogItem},children:e.name})},l=function(e){var s=(0,i.useState)(!1),a=(0,o.Z)(s,2),n=a[0],d=a[1],r=(0,i.useState)(!1),l=(0,o.Z)(r,2),c=l[0],u=l[1],_=e.message.replace(/&quot;/gi,'"').replace(/&#171;/gi,'"').replace(/&#187;/gi,'"');console.log(e.message);var h=e.senderId===e.OwnerId?e.ownerPhoto:e.companionIcon;return(0,g.jsx)("div",{className:n||c?t.activeMessage:t.none,children:(0,g.jsxs)("div",{className:e.senderId===e.OwnerId?t.divOwnerMessage:t.divMessage,onClick:function(){d(!!c||function(e){return!e})},children:[(0,g.jsx)("div",{children:(0,g.jsx)("img",{className:t.iconMessage,src:h})}),(0,g.jsx)("div",{className:e.senderId===e.OwnerId?t.ownerMessageForm:t.messageForm,children:(0,g.jsxs)("a",{className:e.senderId===e.OwnerId?e.viewed?t.ownerTextMessage:t.ownerMessageViewed:e.viewed?t.textMessage:t.textMessageViewed,children:[_,(0,g.jsx)("br",{}),(0,g.jsx)("div",{className:n&&!c?t.deleteMessageOn:t.deleteMessageOff,onClick:function(){d(!0),u((function(e){return!e}))},children:(0,g.jsx)("img",{className:t.deleteMessageIcon,src:"/SocialNetwork/free-icon-delete-6467128.png"})})]})}),(0,g.jsxs)("div",{className:c?t.warningDeleteMessage:t.deleteMessageOff,children:["Are you sure you want to delete the message?",(0,g.jsx)("br",{}),(0,g.jsx)("button",{onClick:function(){e.onDeleteMessageChange(e.messageId),u(!1)},children:"Yes"}),(0,g.jsx)("button",{onClick:function(){u(!1)},children:"No"})]})]})})},c=a(5705),u=a(132),_=function(e){var s=u.Z_();return(0,g.jsx)(c.J9,{initialValues:{textMessage:""},validateOnBlur:!0,onSubmit:function(s,a){var n=a.resetForm;!function(s){e.onMessageSentChange(e.dialogId,s)}(s.textMessage),console.log(s.textMessage),n({values:void 0})},validationSchema:s,children:function(e){var s=e.values,a=e.handleBlur,n=e.handleChange,o=e.isValid,i=e.handleSubmit,d=e.dirty;return(0,g.jsxs)("div",{className:t.divAddMessage,children:[(0,g.jsx)("input",{className:t.inputAddMessage,type:"textarea",name:"textMessage",onChange:n,onBlur:a,value:s.textMessage,placeholder:"Add new message"}),(0,g.jsx)("br",{}),(0,g.jsx)("button",{className:t.buttonAddMessage,disabled:!o&&!d,onClick:function(){i()},type:"submit",children:"Send"})]})}})},h=function(e){return(0,g.jsx)(_,{dialogId:e.dialogId,onMessageSentChange:e.onMessageSentChange})},m=a(8755),M=function(e){var s=(0,m.TL)(),a=function(e){s((0,n.EF)(e))};(0,i.useEffect)((function(){e.getDialogsThunkCreator()}),[]);var c=function(s){e.getMessagesUserThunkCreator(s),function(s){e.dialogs.find((function(a){return a.id===s?e.setCompanionIconAC(a.photos.large?a.photos.large:e.defaultPhoto):e.setCompanionIconAC(e.defaultPhoto)}))}(s)},u=(0,i.useState)([]),_=(0,o.Z)(u,2),M=_[0],f=_[1];(0,i.useEffect)((function(){var s=[];if(e.dialogs.length>0)for(var a=0;a<(e.dialogs.length>10?10:e.dialogs.length);a++)s.push(e.dialogs[a]);f(s),console.log(s)}),[e.dialogs,e.dialogId]);var v=e.dialogs[0]?M.map((function(e){return(0,g.jsx)(r,{name:e.userName,id:e.id,onGetMessagesUser:c},e.id)})):(0,g.jsx)(d.OL,{to:"/users",children:"Search friends"}),x=e.messages[0]?e.messages.map((function(s){return(0,g.jsx)(l,{message:s.body,senderId:s.senderId,OwnerId:e.OwnerId,companionIcon:e.companionIcon,ownerPhoto:e.ownerPhoto,viewed:s.viewed,onDeleteMessageChange:a,messageId:s.id},s.id)})):(0,g.jsx)("div",{children:(0,g.jsx)("h3",{className:t.h3text,children:"start chatting first"})});return(0,g.jsxs)("div",{className:t.dialogs,children:[(0,g.jsx)("div",{className:t.dialogsUsers,children:v}),(0,g.jsxs)("div",{className:t.messages,children:[(0,g.jsx)("div",{className:t.message,children:x}),(0,g.jsx)("div",{className:t.addMessage,children:(0,g.jsx)(h,{dialogId:e.dialogId,onMessageSentChange:function(s,a){e.postMessageToUserThunkCreator(s,a)}})})]})]})},f=a(6434),v=a(7781),x=a(3502),p=(0,v.qC)((0,f.$j)((function(e){return{dialogs:e.dialogs.dialogs,messages:e.dialogs.messages,isAuth:e.auth.isAuth,dialogId:e.dialogs.dialogId,OwnerId:e.auth.userId,companionId:e.dialogs.companionId,companionIcon:e.dialogs.companionIcon,defaultPhoto:e.dialogs.defaultPhoto,ownerPhoto:e.auth.ownerPhoto}}),{getDialogsThunkCreator:n.kp,getMessagesUserThunkCreator:n.rm,postMessageToUserThunkCreator:n.C7,setCompanionIconAC:n.Uh}),x.S)(M)},3502:function(e,s,a){a.d(s,{S:function(){return _}});var n=a(8683),o=a(5671),i=a(3144),t=a(136),d=a(7277),g=a(2791),r=a(6434),l=a(6871),c=a(184),u=function(e){return{isAuth:e.auth.isAuth}},_=function(e){var s=function(s){(0,t.Z)(g,s);var a=(0,d.Z)(g);function g(){return(0,o.Z)(this,g),a.apply(this,arguments)}return(0,i.Z)(g,[{key:"render",value:function(){return this.props.isAuth?(0,c.jsx)(e,(0,n.Z)({},this.props)):(0,c.jsx)(l.Fg,{to:"/login"})}}]),g}(g.Component);return(0,r.$j)(u)(s)}}}]);
//# sourceMappingURL=742.bb66c28f.chunk.js.map